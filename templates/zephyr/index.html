{% extends "zephyr/base.html" %}

    <title>Humbug, from Humbug Inc.</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
{% load jstemplate %}


{% block customhead %}

<script id="template_zephyr" type="text/x-handlebars-template">
{% rawjstemplate "zephyr" %}
</script>

<script id="template_subscription" type="text/x-handlebars-template">
{% rawjstemplate "subscription" %}
</script>

{% autoescape off %}
<link href="/static/styles/zephyr.css?dummy_time={% now "U" %}" rel="stylesheet">
<link href="/static/styles/pygments.css" rel="stylesheet">
<script type="text/javascript" src="/static/third/jquery/jquery.form.js"></script>
<script type="text/javascript" src="/static/third/handlebars/handlebars-1.0.rc.1.js"></script>
<script type="text/javascript" src="/static/third/spin/spin.min.js"></script>
<script type="text/javascript" src="/static/third/jquery-mousewheel/jquery.mousewheel.js"></script>
<script type="text/javascript" src="/static/third/jquery-throttle-debounce/jquery.ba-throttle-debounce.min.js"></script>
<script type="text/javascript" src="/static/js/setup.js"></script>
<script type="text/javascript" src="/static/js/dom_access.js"></script>
<script type="text/javascript" src="/static/js/narrow.js"></script>
<script type="text/javascript" src="/static/js/compose.js"></script>
<script type="text/javascript" src="/static/js/subscribe.js"></script>
<script type="text/javascript" src="/static/js/ui.js"></script>
<script type="text/javascript" src="/static/js/hotkey.js"></script>
<script type="text/javascript" src="/static/js/zephyr.js"></script>

{% if debug %}
<script type="text/javascript" src="/static/js/debug.js"></script>
{% endif %}

<script type="text/javascript">
var initial_pointer = {{ user_profile.pointer }};
var email = "{{ user_profile.user.email }}";
// class_list only contains lower-case names.
var class_list = {{ classes }};
var people_list = {{ people }};
var have_initial_messages = {{ have_initial_messages }};
</script>
{% endautoescape %}
{% endblock %}
{% block content %}
    <div class="row">
        <div class="span3">
          <div class="row">
            <div class="span3 sidebar-nav affix">
                <ul class="nav nav-pills nav-stacked nav-zephyr" id="sidebar">
                    <span class="my_fullname">{{ user_profile.full_name }}</span><br/>
                    <span class="my_email">{{ user_profile.user.email }}</span>
                    <span class="logout">(<a href="/accounts/logout?next=/accounts/login">not you?</a>)</span>
                    <li class="active"><a href="#home" data-toggle="pill"><i class="icon-home"></i> Home</a></li>
                    <li><a href="#subscriptions" data-toggle="pill"><i class="icon-globe"></i> Subscriptions</a></li>
                    <li class="disabled"><a href="#"><i class="icon-star"></i> Starred</a></li>
                    <li><a href="#settings" data-toggle="pill"><i class="icon-edit"></i> Settings</a></li>
                    <li class="disabled"><a href="#"><i class="icon-envelope"></i> Invite a friend</a></li>

                    {% if show_debug %}
                    <li><a href="#debug" data-toggle="pill"><i class="icon-barcode"></i> Debug</a></li>
                    {% endif %}

                    <br>
                    <button type="button" class="btn btn-large btn-block" id="new_message_button" onclick="compose_button();">New Message</button>
                </ul>

                <div class="alert alert_sidebar alert-error" id="connection-error">
                  <strong>Can't receive messages</strong> &mdash; try reloading the page.
                </div>
                <div class="alert alert_sidebar" id="home-error"></div>
                <div class="alert alert_sidebar" id="class-dne">
                  <p>The class <span class="classname" id="class-dne-name"></span> does not exist.</p>
                  <a id="create-it" class="btn btn-primary" href="#">Create and send</a>
                  <a class="btn" onClick="$('#class-dne').stop(true).fadeOut(500);">Cancel message</a>
                </div>
                <div class="alert alert_sidebar" id="class-nosub">
                  <p>You're not subscribed to the class <span class="classname" id="class-nosub-name"></span>.</p>
                  <a id="sub-it" class="btn btn-primary" href="#">Subscribe and send</a>
                  <a class="btn" onClick="$('#class-nosub').stop(true).fadeOut(500);">Cancel message</a>
                </div>
            </div>
          </div>
        </div><!--/sidebar-->
        <div class="span9 tab-content" id="application_area">
            <div class="tab-pane active" id="home">
                {% include "zephyr/home.html" %}
            </div>
            <div class="tab-pane" id="subscriptions">
                {% include "zephyr/subscriptions.html" %}
            </div>
            <div class="tab-pane" id="settings">
                {% include "zephyr/settings.html" %}
            </div>

            {% if show_debug %}
            <div class="tab-pane" id="debug">
                {% include "zephyr/debug.html" %}
            </div>
            {% endif %}

        </div><!--/tab-content-->
    </div><!--/row-->

{% endblock %}
