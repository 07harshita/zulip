server {
    listen 80;
    return 301 https://$host$request_uri;
}
server {
    listen 443;

    ssl on;
    ssl_certificate /etc/ssl/certs/zulip-local-server.combined-chain.crt;
    ssl_certificate_key /etc/ssl/private/zulip-local-server.key;

    add_header X-Frame-Options DENY;

    location /user_uploads {
        add_header X-Content-Type-Options nosniff;
        include /etc/nginx/zulip-include/uploads.types;
        alias /home/zulip/uploads/files;
    }

    location /user_avatars {
        add_header X-Content-Type-Options nosniff;
        include /etc/nginx/zulip-include/uploads.types;
        alias /home/zulip/uploads/avatars;
    }

    include /etc/nginx/zulip-include/app;
}
