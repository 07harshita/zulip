<VirtualHost *:80>
    ServerName nagios.humbughq.com
    Redirect permanent / https://nagios.humbughq.com/
</VirtualHost>

<VirtualHost *:443>
    ServerName nagios.humbughq.com

    SSLEngine on
    SSLCertificateFile /etc/apache2/certs/humbug-self-signed.crt
    SSLCertificateKeyFile /etc/apache2/certs/humbug-self-signed.key

    Header add Strict-Transport-Security "max-age=15768000"
    Header add X-Frame-Options DENY

    ScriptAlias /cgi-bin/nagios3 /usr/lib/cgi-bin/nagios3
    ScriptAlias /nagios3/cgi-bin /usr/lib/cgi-bin/nagios3

    # Where the stylesheets (config files) reside
    Alias /nagios3/stylesheets /etc/nagios3/stylesheets

    # Where the HTML pages live
    Alias /nagios3 /usr/share/nagios3/htdocs

    RedirectMatch ^/?$ https://nagios.humbughq.com/nagios3/

    <Location "/">
        AuthType Digest
        AuthName "wiki"
        AuthDigestProvider file
        AuthUserFile /etc/apache2/users/wiki
        Require valid-user
    </Location>

    <DirectoryMatch (/usr/share/nagios3/htdocs|/usr/lib/cgi-bin/nagios3|/etc/nagios3/stylesheets)>
        Options FollowSymLinks

        DirectoryIndex index.php index.html

        AllowOverride AuthConfig
        Order Allow,Deny
        Allow From All
    </DirectoryMatch>

    <Directory /usr/share/nagios3/htdocs>
        Options +ExecCGI
    </Directory>

    # Enable this ScriptAlias if you want to enable the grouplist patch.
    # See http://apan.sourceforge.net/download.html for more info
    # It allows you to see a clickable list of all hostgroups in the
    # left pane of the Nagios web interface
    ScriptAlias /nagios3/side.html /usr/lib/cgi-bin/nagios3/grouplist.cgi
</VirtualHost>
